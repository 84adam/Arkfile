# .env.example

# Environment Configuration
# - Copy this file to /opt/arkfile/etc/[env]/secrets.env for each environment
# - Replace [env] with either 'prod' or 'test'
# - Each environment should have its own configuration file with appropriate values

# Application Environment
# This determines which environment configuration to use
ENV=prod  # or 'test'

# Domain Configuration
DOMAIN=arkfile.net

# Service Configuration
PORT=8080
BASE_DIR=/opt/arkfile
SERVICE_USER=arkfile

# rqlite Database Configuration
RQLITE_NODES=localhost:4001        # Comma-separated list of rqlite nodes
RQLITE_USERNAME=admin              # rqlite authentication username
RQLITE_PASSWORD=your_secret_here   # rqlite authentication password

# Security Configuration
# Generate new secrets using: openssl rand -hex 32
# JWT Configuration (Ed25519 Keys)
# JWT keys are generated automatically by the setup scripts at:
# /opt/arkfile/etc/keys/jwt/current/signing.key (private)
# /opt/arkfile/etc/keys/jwt/current/public.key (public)
# These paths can be overridden with environment variables:
# JWT_PRIVATE_KEY_PATH=/path/to/private.key
# JWT_PUBLIC_KEY_PATH=/path/to/public.key

# JWT Token Lifetime Configuration
# Token lifetime in minutes (default: 30 minutes for Netflix/Spotify model)
# Shorter tokens improve security but require more frequent refreshes
JWT_TOKEN_LIFETIME_MINUTES=30

# ============================================================================
# ADMIN CONFIGURATION
# ============================================================================

# SECURITY WARNING: These are DEV-ONLY admin accounts!
# NEVER use arkfile-dev-admin, admin.dev.user, or admin.demo.user in production!

# For development:
# ADMIN_USERNAMES=arkfile-dev-admin

# For production (replace with your actual admin usernames):
ADMIN_USERNAMES=your-production-admin-username,second-admin-username

# The application will BLOCK dev admin accounts if ENVIRONMENT=production
ENVIRONMENT=development

# Dev/Test Admin API Configuration
# Controls whether development/testing admin API endpoints are available
# CRITICAL: Must be false in production to prevent exposure of dev/test endpoints
ADMIN_DEV_TEST_API_ENABLED=false

# Legacy email-based admin configuration (still supported)
# Comma-separated list of admin email addresses
# These users will:
# - Be automatically approved upon registration
# - Have admin privileges to approve other users
# - Be able to modify user storage limits
ADMIN_EMAILS=admin@domain.com,admin2@domain.com

# User Approval Configuration
# Set to true to require admin approval for new user accounts
# Set to false to automatically approve all new registrations
REQUIRE_APPROVAL=true

# Storage Configuration
# Default storage limit is 10GB per user
# Admins can modify individual user limits through the API
# Storage size is tracked in bytes for all uploaded files

# Storage Configuration
# Supported providers: local, cluster, backblaze, wasabi, vultr, aws-s3
STORAGE_PROVIDER=local  # Choose provider type (default: local for demo)

# Local Storage Configuration (when STORAGE_PROVIDER=local)
LOCAL_STORAGE_PATH=/opt/arkfile/var/lib/${ENV}/minio/data
MINIO_ROOT_USER=minioadmin    # Override default MinIO credentials if needed
MINIO_ROOT_PASSWORD=minioadmin # Override default MinIO credentials if needed

# MinIO Cluster Configuration (when STORAGE_PROVIDER=cluster)
MINIO_CLUSTER_NODES=localhost:9000           # Comma-separated list of node addresses
MINIO_CLUSTER_ACCESS_KEY=your_cluster_key    # Cluster authentication
MINIO_CLUSTER_SECRET_KEY=your_cluster_secret # Cluster authentication
MINIO_CLUSTER_BUCKET=arkfile                 # Default bucket name

# Amazon S3 Configuration (when STORAGE_PROVIDER=aws-s3)
AWS_REGION=us-west-2                        # AWS region (defaults to us-east-1 if not set)
AWS_ACCESS_KEY_ID=your_aws_access_key       # AWS IAM access key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key   # AWS IAM secret key
AWS_S3_BUCKET_NAME=arkfile-bucket          # S3 bucket name

# S3-Compatible Storage Configuration (when STORAGE_PROVIDER=backblaze/wasabi/vultr)
S3_ENDPOINT=s3.something.backblazeb2.com  # Required for Backblaze
S3_REGION=us-west-1        # Required for Wasabi/Vultr (e.g., us-west-1 for Wasabi, ewr for Vultr)
S3_ACCESS_KEY_ID=your_key_id
S3_SECRET_KEY=your_secret_key
S3_BUCKET_NAME=your_bucket_name  # e.g., arkfile-prod or arkfile-test

# Provider-specific notes:
# Local: Uses MinIO in filesystem mode for local storage
# Cluster: Uses MinIO in distributed mode across multiple nodes
# AWS S3: Uses native Amazon S3, endpoint auto-generated as s3.[region].amazonaws.com
# Backblaze: Only S3_ENDPOINT needs to be set manually
# Wasabi: Requires S3_REGION, endpoint auto-generated as s3.[region].wasabi.com
# Vultr: Requires S3_REGION, endpoint auto-generated as [region].vultrobjects.com

# DNS Challenge Configuration (for Caddy TLS certificates)
# Configure based on your DNS provider:
# CLOUDFLARE_API_TOKEN=your_cloudflare_token
# AWS_ACCESS_KEY_ID=your_aws_key_id
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key
# NAMECHEAP_API_USER=your_namecheap_user
# NAMECHEAP_API_KEY=your_namecheap_key
# Or use HTTP challenge (requires port 80 accessible)

# Caddy Configuration
CADDY_EMAIL=admin@domain.com

# Logging Configuration
LOG_LEVEL=info      # Available levels: debug, info, warn, error
LOG_FORMAT=json     # Available formats: json, text

# TLS Configuration (for local development only)
TLS_ENABLED=false   # Set to true in production
TLS_CERT_FILE=      # Only used if TLS_ENABLED=true
TLS_KEY_FILE=       # Only used if TLS_ENABLED=true

# Service Dependencies
# These settings are used by systemd service templates
WANTS_SERVICES=caddy.service  # Additional services to wait for

# Release Management
KEEP_RELEASES=5    # Number of previous releases to maintain

# Example Environment-Specific Values:
#
# Production (/opt/arkfile/etc/prod/secrets.env):
# ENV=prod
# DOMAIN=arkfile.net
# PORT=8080
# SERVICE_USER=arkfile
# RQLITE_NODES=node1:4001,node2:4001,node3:4001
# RQLITE_USERNAME=admin
# RQLITE_PASSWORD=<unique-prod-password>
# JWT keys generated by setup scripts
# S3_BUCKET_NAME=arkfile-prod
# ADMIN_EMAILS=admin@domain.com
#
# Test (/opt/arkfile/etc/test/secrets.env):
# ENV=test
# DOMAIN=test.arkfile.net
# PORT=8080
# SERVICE_USER=arkfile
# RQLITE_NODES=localhost:4001
# RQLITE_USERNAME=admin
# RQLITE_PASSWORD=<unique-test-password>
# JWT keys generated by setup scripts
# S3_BUCKET_NAME=arkfile-test
# ADMIN_EMAILS=testadmin@domain.com

# Security Note:
# - All passwords and secrets should be unique per environment
# - Generate secrets using: openssl rand -hex 32
# - Never reuse secrets between environments
# - Store secrets securely and never commit to version control
# - Admin email addresses should be carefully controlled and reviewed
# - Consider using separate admin accounts for prod and test environments

# Note: This file serves as a template and documentation.
# Never commit actual secrets or credentials to version control.
# Each environment should have its own secrets.env file with real values.
